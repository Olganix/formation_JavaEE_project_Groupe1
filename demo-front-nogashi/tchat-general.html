<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
	<title>Tchat général</title>
	
              <!-- FAVICON -->
      <link rel="shortcut icon" href="../ico/favicon.png"> 
            
             <!-- GOOGLE-FONT -->
      <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,500,700,700i&display=swap" rel="stylesheet"> 
      <link href="https://fonts.googleapis.com/css?family=Shadows+Into+Light+Two&display=swap" rel="stylesheet">         
              <!-- Bootstrap -->
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">    
          <!-- BALISE FontAwesome -->
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
           
             <!-- RESET CSS -->
      <link rel="stylesheet" href="css/reset.css"> 
                <!-- CSS -->
      <link rel="stylesheet" href="css/tchat.css"> 
                 

    <script> 
        window.addEventListener('DOMContentLoaded', function(){
            let xhr = new XMLHttpRequest();
            xhr.responseType = 'json';
            let input = document.querySelector("#contenu-message");
            
            document.querySelector('#tchat').addEventListener('submit', function(evt){
                evt.preventDefault();
                
                // Se passe après le open et send
                xhr.onreadystatechange = function(){

                    if( xhr.readyState === xhr.DONE && xhr.status === 200 ){
                        if ( (xhr.response.exists) && (xhr.response.status === "SUCCESS") ) {
                            rebuildMessages(xhr.response.data);
                        }
                    }
                };
                
                xhr.open('GET', `http://localhost:8080/nogashi/addMsg?messageContent=${input.value}`);
                xhr.send();
             
            });

            
            function rebuildMessages(messages) {
                let historique = document.querySelector('#historique');
                
                for(let hist of historique.childNodes) {
                    historique.removeChild(hist);
                }
                
                for(let msg of messages) {
                    historique.innerHTML += `<p>${msg.date.hour}:${msg.date.minute} : ${msg.messageContent}</p>`;
                }
            }
            

        });
    </script>


</head>
<body>
         
         
 <div class="background"> <!-- Background => Dévoilement du footer-->          
        
                    <!-- Menu-->
    <header>
       <div class="menu">
           <a href="index.html"><div class="cercle"><i class="fab fa-maxcdn"></i></div></a>
           <div class="icones-menu">
             <div class="icones-user">
                   <i class="fas fa-user-circle"></i>
                   <div class="bloc-compte">
                        <i class="fas fa-sort-up"></i>
                        <ul class="compte">
                            <a href="connexion.html"><li class="onglet-menu">Se Connecter</li></a>
                            <div class="trait-compte"></div>
                            <a href="inscription.html"><li class="onglet-menu">S'inscrire</li></a>
                        </ul> 
                    </div> 
               </div>
               <div class="icone-panier">
                   <a href=""><div class="icones"><i class="fas fa-shopping-bag"></i></div>
                       <div class="cercle-prix">3</div>
                   </a>    
               </div>
               <div class="icone-hamburger">
                   <div id="hamburger-menu" class="icones"><i class="fas fa-bars"></i></div>
               </div>
           </div>
            
           <div id="bloc-menu" class="bloc-menu col-12">
                <a href="index.html">
                     <div id="bloc-quitter" class="bloc-quitter">
                         <div class="croix-quitter">
                               <span class="barre-croix"></span>
                               <span class="barre-croix2"></span>
                         </div>
                     </div>
                </a>  
                <nav>
                   <ul>
                       <a href="index.html"><li class="onglet-menu-principal">Accueil</li></a>
                       <a href="trouver.html"><li class="onglet-menu-principal">Ou Nous Trouver ?</li></a>
                       <a href="faq.html"><li class="onglet-menu-principal">F.A.Q</li></a>
                   </ul> 
               </nav>
           </div>    
        </div> 
    </header>   
    
              
              
          <!-- SECTION -> Tchat -->
   <section class="section-tchat">
       <div class="container">
           <div class="row">
              <div class="bloc-titre-tchat col-12">
                   <h1 class="titre-tchat">// TCHAT <i class="far fa-comment-dots"></i></h1>
                   <br>
                   <br>
                   <p class="texte-tchat col-8">Etenim si attendere diligenter, existimare vere de omni hac causa volueritis, sic constituetis, iudices, nec descensurum. Etenim si attendere diligenter, existimare vere de.</p>
                   <br>   
               </div> 
          </div>   
        </div>            
     </section> 
                   
     <section class="section-conversation">
          <div class="container">
               <div class="row no-gutters">
                   <div class="bloc-conversation col-12">
                       <div class="conversation col-10">
                            <div class="champs-conversation" action="">
                               <p class="texte-ecriture"><i class="far fa-comment-dots"></i> Historique des conversations :</p>
                                <div id="historique" class="textarea-conversation " name="">
                                </div>
                            </div>
                       </div>     
                       <div class="bloc-detail col-2">
                           <div class="avatar">
                               <img class="logo-commerce" src="css/img/commerce/boulangerie-mathieu.jpeg" alt="logo du commerce">
                           </div> 
                           <div class="bloc-nom-commerce">
                               <p class="nom-commerce">Boulangerie Mathieu</p>
                           </div>
                           <div class="bloc-presence">
                               <p class="ligne">en ligne</p>
                           </div>
                       </div>   
                   </div>      
               </div>
          </div>
      </section>   
      <section class="section-message">
          <div class="container">
              <div class="row no-gutters">
                 <div class="bloc-message col-10">
                    <form method="post" id="tchat">
                        <div class="ecriture-message">
                           <!--<div class="avatar col-1">
                               <img class="image-profil" src="css/img/profil/profil.png" alt="">
                           </div> -->
                           <div class="zone-ecriture col-12">
                               <p class="texte-ecriture"><i class="far fa-comment-dots"></i> Ecrivez votre message ici :</p>
                               <textarea class="textarea-ecriture" name="" id="contenu-message" cols="30" rows="10"></textarea> 
                           </div>
                       </div> 
                       <div class="bloc-envoyer col-12">
                           <button type="submit" id ="bouton-envoyer" class="bouton-envoyer">envoyer message</button>
                       </div>  
                    </form> 
                 </div> 
              </div>
          </div>       
      </section>                
                
                   
                  
    
       
            <!-- RESEAUX SOCIAUX -->
   <ul class="social-medias">
        <li>
            <a href="https://fr-fr.facebook.com/"><i class="fab fa-facebook-f"></i></a>
        </li>
        <li class="twitter">
            <a href="https://www.google.com/search?client=firefox-b&q=twitter"><i class="fab fa-twitter"></i></a>
        </li>
        <li>
            <a href="https://plus.google.com/discover"><i class="fab fa-google-plus-g"></i></a>
        </li>
    </ul>
  	
               <!-- BOUTON UP -->
    <div class="fond-up">
       <div id="bouton-up" class="bouton-up">
           <i class="fas fa-chevron-up"></i>
       </div> 
    </div> 
 </div> <!-- Fin du Background => Dévoilement du footer--> 
   
    
    <footer>
        <div class="footer">
           <div class="container">
               <div class="row">
                   <div class="bloc-centre-footer col-12">
                       <div class="adresse-footer col-4">
                           <ul class="ul-menu-footer">
                               <li class="titre-footer"><span class="trait-footer">//</span> CONTACTEZ-NOUS</li>
                               <li class="menu-footer"><i class="fas fa-phone"></i> -  03.20.30.79.73</li>
                               <li class="menu-footer"><i class="fas fa-map"></i> - 1 Rue Esquermoise, 59800</li>
                               <a href=""><li class="menu-footer"><i class="fas fa-envelope"></i> - nogashis@gmail.com</li></a>
                           </ul> 
                           <hr>
                       </div>
                       <div class="ul col-4">
                           <ul class="ul-menu-footer">
                                <li class="titre-footer"><span class="trait-footer">//</span> NOTRE CONCEPT</li>
                                <a href="index.html"><li class="menu-footer2">- Accueil -</li></a>
                                <a href="trouver.html"><li class="menu-footer2"> - Ou Nous Trouver ? -</li></a>
                               <a href="faq.html"><li class="menu-footer2">- F.A.Q -</li></a>
                           </ul> 
                           <hr>   
                       </div>
                       <div class="reseau-footer col-4">
                           <ul class="ul-menu-footer">
                               <li class="titre-footer"><span class="trait-footer">//</span> SUIVEZ-NOUS SUR </li>
                               <a href="">
                               <li class="menu-footer2"><i class="fab fa-facebook-square"></i> Facebook</li>
                               </a>
                               <a href=""><li class="menu-footer2"><i class="fab fa-twitter-square"></i> Twitter</li></a>
                               <a href=""><li class="menu-footer2"><i class="fab fa-google-plus-square"></i> Google +</li></a>
                           </ul>
                           <hr>
                       </div>
                       <div class="trait-footer"></div>
                   </div>    
               </div>
           </div>
           <a href="mentions.html"><P class="lien-mentions">- Mentions légales -</P></a>
        </div>  
        <div class="informations-footer">Site réalisé par <span class="italic-footer">Anais Kordek - Olivier Vanhée - Joffrey Chassat - Francis Berthe.</span> Nom App - Formation Dawan, <span class="italic-footer">2019</span></div>  
    </footer>
      
               
          
     
                <!-- JavaScript/ MENU -->
          <script src="js/menuApp.js"></script> 
                <!-- JavaScript/ BOUTON -->
          <script src="js/bouton.js"></script>
                <!-- JavaScript/ MAIN -->
          <script src="js/main.js"></script>
          
          

</body>
</html>